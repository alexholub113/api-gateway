{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },
  "AllowedHosts": "*",
  "Gateway": {
    "TargetServices": [
      {
        "ServiceId": "target-service",
        "LoadBalancingStrategy": "RoundRobin",
        "Instances": [
          {
            "Address": "https://localhost:7069",
            "Weight": 1
          },
          {
            "Address": "https://localhost:7070",
            "Weight": 2
          }
        ],
        "RateLimitPolicy": {
          "RequestsPerWindow": 100,
          "WindowSize": "00:01:00",
          "Algorithm": "SlidingWindow"
        },
        "CachePolicy": {
          "Duration": "00:05:00",
          "Methods": ["GET", "HEAD"],
          "VaryByHeaders": ["Accept"],
          "VaryByQuery": true,
          "VaryByUser": false
        },
        "AuthPolicy": null
      },
      {
        "ServiceId": "protected-service",
        "LoadBalancingStrategy": "RoundRobin",
        "Instances": [
          {
            "Address": "https://localhost:7071",
            "Weight": 1
          },
          {
            "Address": "https://localhost:7069",
            "Weight": 2
          },
          {
            "Address": "https://localhost:7075",
            "Weight": 3
          }
        ],
        "RateLimitPolicy": null,
        "CachePolicy": null,
        "AuthPolicy": {
          "ValidIssuers": [
            "https://your-identity-provider.com",
            "https://localhost:5000"
          ],
          "ValidAudiences": [
            "protected-api",
            "gateway-api"
          ]
        }
      },
      {
        "ServiceId": "third-service",
        "LoadBalancingStrategy": "RoundRobin",
        "Instances": [
          {
            "Address": "https://localhost:7073",
            "Weight": 1
          },
          {
            "Address": "https://localhost:7074",
            "Weight": 2
          }
        ],
        "RateLimitPolicy": null,
        "CachePolicy": null,
        "AuthPolicy": null
      }
    ],
    "LoadBalancing": {
      "DefaultStrategy": "RoundRobin",
      "HealthCheckPath": "/health",
      "HealthCheckIntervalSeconds": 30,
      "HealthCheckTimeoutSeconds": 5,
      "MaxConsecutiveFailures": 3,
      "UnhealthyRetryDelaySeconds": 60
    },
    "Proxy": {
      "TimeoutSeconds": 30,
      "MaxRetries": 3,
      "RetryDelayMs": 1000,
      "UseExponentialBackoff": true,
      "CircuitBreakerFailureThreshold": 5,
      "CircuitBreakerSamplingDurationSeconds": 30,
      "CircuitBreakerBreakDurationSeconds": 60,
      "PreserveHostHeader": false,
      "ExcludedHeaders": [
        "Host",
        "Connection",
        "Transfer-Encoding",
        "Upgrade",
        "Proxy-Connection",
        "Proxy-Authorization"
      ]
    },
    "Caching": {
      "EnableCaching": true,
      "DefaultProvider": "Memory",
      "Memory": {
        "SizeLimit": 1000,
        "DefaultExpiration": "00:05:00"
      }
    },
    "RateLimiting": {
      "EnableGlobalRateLimit": false
    }
  }
}
